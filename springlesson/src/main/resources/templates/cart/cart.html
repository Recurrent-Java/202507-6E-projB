<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <div th:replace="~{comlayout/base :: meta}"></div>
  <div th:replace="~{comlayout/base :: styles}"></div>
  <!-- Original CSS -->
  <link rel="stylesheet" th:href="@{/css/cart.css}">
  <title>カート | 宅配寿司 寿司処リカレント | お寿司の出前・デリバリー・配達注文</title>
</head>

<body>
  <div class="wrapper">
    <div class="inner" id="unique_cart_area">

      <div th:replace="~{comlayout/base :: header}"></div>
      <div th:replace="~{comlayout/base :: nav}"></div>

      <!-- メイン -->
      <main>
        <h2 class="mn_h201">カート</h2>
        <ol class="mn_pankuzu">
          <li><a th:href="/">TOPページ</a></li>
          <li><a th:href="@{/product}">商品一覧</a></li>
          <li>カート</li>
        </ol>

        <div class="cart_wrap">

          <!-- フロー図 -->
          <div class="progressbar">
            <div class="item active">STEP.1<br>購入商品の確認</div>
            <div class="item">STEP.2<br>お届け先を設定</div>
            <div class="item">STEP.3<br>最終確認</div>
            <div class="item">STEP.4<br>購入完了</div>
          </div>

          <table>
            <tr>
              <th colspan="2">商品名</th>
              <th>単価(税込)</th>
              <th>数量</th>
              <th>小計</th>
              <th>削除</th>
            </tr>
            <tr th:each="item : ${cartItem}">
              <td class="td_img"><img th:src="@{${item.product.imageUrl}" alt="商品画像"></td>
              <td class="td_name" th:text="${item.product.name}">商品名</td>
              <td class="td_price01" th:text="${#numbers.formatInteger(item.unitPrice, 0)} + '円'">200円</td>

              <td class="td_count">
                <div class="product_qty">

                  <form th:action="@{/cart/updatedAt}" method="post">
                    <input type="hidden" name="productId" th:value="${item.product.id}">
                    <input type="hidden" name="quantity" th:value="${item.quantity - 1}">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="qty_btn" th:disabled="${item.quantity <= 1}">―</button>
                  </form>

                  <span class="qty_num" th:text="${item.quantity}">1</span>

                  <form th:action="@{/cart/updatedAt}" method="post">
                    <input type="hidden" name="productId" th:value="${item.product.id}">
                    <input type="hidden" name="quantity" th:value="${item.quantity - 1}">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="qty_btn">＋</button>
                  </form>

                </div>
              </td>
              <td class="td_price01" th:text="${#numbers.formatInteger(item.unitPrice * item.quantity, 0)} + '円'">600円
              </td>

              <td class="td_delete">
                <form th:action="@{/cart/delete}" method="post">
                  <input type="hidden" name="productId" th:value="${item.product.id}">
                  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                  <button type="submit">削除</button>
              </td>
              </form>
            </tr>

            <tr class="td_total01">
              <td colspan="5">商品合計(税込)</td>
              <td th:text="${#numbers.formatInteger(total, 0) + '円'">2,500円</td>
            </tr>
          </table>
        </div>

        <div class="cart_btnarea">
          <div class="btn_product">
            <a th:href="@{/product}"><i class="fas fa-angle-double-left fa-position-right"></i>商品一覧に戻る</a>
          </div>
          <div class="btn_purchase">
            <a th:href="@{purchase-in}">お届け先を設定<i class="fas fa-angle-double-right fa-position-left"></i></a>
          </div>
        </div>




      </main><!-- メイン END -->
    </div><!-- inner END -->

    <div th:replace="~{comlayout/base :: footer}"></div>



  </div><!-- wrapper END -->
</body>

</html>